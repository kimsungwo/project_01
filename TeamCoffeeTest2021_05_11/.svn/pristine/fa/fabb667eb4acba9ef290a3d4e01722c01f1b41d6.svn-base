package com.teamcoffee.review.controller;


import java.util.List;

import javax.annotation.Resource;
import javax.servlet.http.HttpSession;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import com.teamcoffee.buy.service.BuyService;
import com.teamcoffee.buy.vo.BuyVO;
import com.teamcoffee.buy.vo.BuyViewVO;
import com.teamcoffee.member.vo.MemberVO;
import com.teamcoffee.review.service.ReviewService;
import com.teamcoffee.review.vo.ReviewVO;

@Controller
@RequestMapping("/review")
public class ReviewController {
	
	@Resource(name = "reviewService")
	private ReviewService reviewService;
	
	@Resource(name = "buyService")
	private BuyService buyService;
	
	@ResponseBody
	@PostMapping("/reviewForm")
	public List<BuyViewVO> reviewForm(BuyVO buyVO) {
	List<BuyViewVO> result = buyService.selectBuyDetailForReviewForm(buyVO);
		return result;
	}
	
	@ResponseBody
	@PostMapping("/insertReview")
	public void insertReview(ReviewVO reviewVO, HttpSession session) {
		MemberVO member = (MemberVO)session.getAttribute("memberLoginInfo");
		reviewVO.setMemCode(member.getMemCode());
		reviewService.insertReview(reviewVO);
	}
}
