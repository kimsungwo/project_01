<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   <!-- 테이블에 대한 모든 SQL문을 mapper태그 안에 작성 -->
<mapper namespace="sampleMapper2">
	<!--  먼저 resultMap을 만들어준다.-->
	<!-- resultMap : 쿼리 실행결과 나온 데이터를 자바로 가져올 수 있도록 자바클래스와 결과를 연결(매핑)시켜주는 작업 -->
	<!--  resultmap작성 -->
	<resultMap type="com.spring.vo.SampleVO2" id="Sample2">
		<id column="EMPNO" property="empno"/>
		<result column="ENAME" property="eName"/>
		<result column="JOB" property="job"/>
		<result column="AGE" property="age"/>
		<result column="GENDER" property="gender"/>
		<result column="TEL" property="tel"/>
		<result column="DEPTNO" property="deptno"/>
		<result column="DNAME"  property="dName"/>
		<result column="LOC" 	property="loc"/>
	</resultMap>
		<insert id="insertEmp">
		INSERT INTO TEST_EMP (
			EMPNO
			, ENAME
			, JOB
			, GENDER
			, TEL
			, DEPTNO
			, AGE
		) VALUES (
			(SELECT 'EMP'||LPAD(NVL(MAX(TO_NUMBER(SUBSTR(EMPNO,5)))+1,1),3,'0') FROM TEST_EMP ) 
            , #{eName}
            , #{job}
            , #{gender}
            , #{tel}
            , #{deptno}
            , #{age}
        )
	</insert>
	<select id="selectEmpList" resultMap="Sample2">
		SELECT EMPNO
 		   , ENAME
 		   , TEL
 		   , GENDER
 		   , AGE
 		   , TEST_DEPARTMENT.DEPTNO AS DEPTNO
 		   , TEST_DEPARTMENT.DNAME AS DNAME
 		   , TEST_DEPARTMENT.LOC AS LOC
		FROM TEST_DEPARTMENT INNER JOIN TEST_EMP 
		ON TEST_DEPARTMENT.DEPTNO = TEST_EMP.DEPTNO   
	</select>
	
</mapper>